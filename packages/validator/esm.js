"use strict";var oo=Object.create;var Cr=Object.defineProperty;var io=Object.getOwnPropertyDescriptor;var ao=Object.getOwnPropertyNames;var br=Object.getPrototypeOf,uo=Object.prototype.hasOwnProperty;var co=Reflect.get;var vr=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(r,e)=>(typeof require!="undefined"?require:r)[e]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var j=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports);var lo=(t,r,e,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of ao(r))!uo.call(t,o)&&o!==e&&Cr(t,o,{get:()=>r[o],enumerable:!(s=io(r,o))||s.enumerable});return t};var U=(t,r,e)=>(e=t!=null?oo(br(t)):{},lo(r||!t||!t.__esModule?Cr(e,"default",{value:t,enumerable:!0}):e,t));var Pr=(t,r,e)=>co(br(t),e,r);var D=(t,r,e)=>new Promise((s,o)=>{var u=y=>{try{l(e.next(y))}catch(E){o(E)}},c=y=>{try{l(e.throw(y))}catch(E){o(E)}},l=y=>y.done?s(y.value):Promise.resolve(y.value).then(u,c);l((e=e.apply(t,r)).next())});var At=j(Ft=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});var ye=class extends Error{constructor(...r){super(...r),this.message=r[0],this.detail=r[1],this.className=ye.name,Error.captureStackTrace&&Error.captureStackTrace(this,ye)}};Ft.default=ye});var Ie=j(Et=>{"use strict";Object.defineProperty(Et,"__esModule",{value:!0});var _e=class extends Error{constructor(...r){super(...r),this.message=r[0],this.detail=r[1],this.className=_e.name,Error.captureStackTrace&&Error.captureStackTrace(this,_e)}};Et.default=_e});var Xe=j(He=>{"use strict";Object.defineProperty(He,"__esModule",{value:!0});He.trueTypeOf=void 0;function fo(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}He.trueTypeOf=fo});var Ne=j(G=>{"use strict";Object.defineProperty(G,"__esModule",{value:!0});G.isString=G.flatMap=G.merge=G.curry=void 0;var po=Xe(),wt=ue(),mo=(t,...r)=>t.length<=r.length?t(...r):(...e)=>(0,G.curry)(t,...r,...e);G.curry=mo;var yo=(t,...r)=>{if(!r.length)return t;let e=r.shift();if((0,wt.isObject)(t)&&(0,wt.isObject)(e))for(let s in e)(0,wt.isObject)(e[s])?(t[s]||Object.assign(t,{[s]:{}}),(0,G.merge)(t[s],e[s])):Object.assign(t,{[s]:e[s]});return(0,G.merge)(t,...r)};G.merge=yo;function _o(t,r){return r||(r=e=>e),t.flatMap(r)}G.flatMap=_o;function ho(t){return(0,po.trueTypeOf)(t)==="string"}G.isString=ho});var Ze=j(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});K.formatStr=K.showDeep=K.nil=K.createEvtName=K.parseJson=K.toArray=K.inArray=void 0;var go=Ne(),Co=(t,r)=>t.includes(r);K.inArray=Co;var bo=t=>Array.isArray(t)?t:[t];K.toArray=bo;var vo=(t,r=!0)=>{try{return(0,go.isString)(t)?JSON.parse(t):JSON.parse(JSON.stringify(t))}catch(e){if(r)return t;throw e}};K.parseJson=vo;var Po=(...t)=>t.join("_");K.createEvtName=Po;var Fo=()=>!1;K.nil=Fo;var Ao=t=>{console.dir(t,{depth:null})};K.showDeep=Ao;function Eo(t,...r){return t.replace(/{([0-9]+)}/g,(e,s)=>typeof r[s]=="undefined"?e:r[s])}K.formatStr=Eo});var ue=j(V=>{"use strict";Object.defineProperty(V,"__esModule",{value:!0});V.readOnly=V.objectHasKey=V.arrToObj=V.assign=V.getConfigValue=V.isClass=V.isPlainObject=V.isObject=void 0;var wo=Ze(),Oo=Xe();function Ot(t){return(0,Oo.trueTypeOf)(t)==="object"}V.isObject=Ot;function Rt(t){if(Ot(t)){let e=t.constructor.prototype,s="[Object: null prototype]";return e.toString().substring(0,s.length)===s?!0:Ot(e)===!1?!1:Reflect.apply(e.hasOwnProperty,e,["isPrototypeOf"])}return!1}V.isPlainObject=Rt;var Ro=t=>!Rt(t);V.isClass=Ro;var jo=(t,r)=>r&&Rt(r)&&t in r?r[t]:void 0;V.getConfigValue=jo;var To=(...t)=>Reflect.apply(Object.assign,Object,t);V.assign=To;var So=(t,r,e={})=>t.map(r).reduce((s,o)=>(0,V.assign)(s,o),e);V.arrToObj=So;var qo=(t,r)=>{try{let e=Object.keys(t);return(0,wo.inArray)(e,r)}catch{return!1}};V.objectHasKey=qo;var xo=t=>Object.freeze(t);V.readOnly=xo});var jt=j(W=>{"use strict";Object.defineProperty(W,"__esModule",{value:!0});W.isEmpty=W.notEmpty=W.isNotEmpty=W.isEmptyObj=void 0;var Fr=ue(),Mo=t=>t&&(0,Fr.isPlainObject)(t)&&Object.keys(t).length===0;W.isEmptyObj=Mo;var Yo=t=>t!=null&&(t+"").trim()!=="";W.isNotEmpty=Yo;function Ar(t,r=!1){return Array.isArray(t)?r?!!t.length:!1:(0,Fr.isPlainObject)(t)?r?!(0,W.isEmptyObj)(t):!1:(0,W.isNotEmpty)(t)}W.notEmpty=Ar;var ko=(t,r)=>!Ar(t,r);W.isEmpty=ko});var Tt=j(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.isAsyncFunction=he.isFunction=void 0;var Er=Xe(),wr=["asyncfunction","function"],Io=function(t,r=!1){let e=(0,Er.trueTypeOf)(t);return wr.includes(e)?!0:(r&&console.error(`Expect to be Function type! Got ${typeof t}`),!1)};he.isFunction=Io;function No(t){return(0,Er.trueTypeOf)(t)===wr[0]}he.isAsyncFunction=No});var jr=j(ne=>{"use strict";Object.defineProperty(ne,"__esModule",{value:!0});ne.queuePromisesProcess=ne.chainProcessPromises=ne.chainPromises=void 0;var Or=Ne(),Do=ue();function Vo(t,r=!1){return t.reduce((e,s)=>e.then(o=>s.then(u=>r===!1?[...o,u]:(0,Or.merge)(o,u))),Promise.resolve(r===!1?[]:(0,Do.isPlainObject)(r)?r:{}))}ne.chainPromises=Vo;function Rr(t,...r){return(...e)=>r.reduce((s,o)=>s.then(u=>o(u)),Reflect.apply(t,null,e))}ne.chainProcessPromises=Rr;function Jo(t,...r){let e=(0,Or.flatMap)(t),s=Reflect.apply(Rr,null,e);return Reflect.apply(s,null,r)}ne.queuePromisesProcess=Jo});var Vr=j(($a,Dr)=>{var Ce=1e3,be=Ce*60,ve=be*60,le=ve*24,Ko=le*7,Lo=le*365.25;Dr.exports=function(t,r){r=r||{};var e=typeof t;if(e==="string"&&t.length>0)return Uo(t);if(e==="number"&&isFinite(t))return r.long?$o(t):Go(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Uo(t){if(t=String(t),!(t.length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!r){var e=parseFloat(r[1]),s=(r[2]||"ms").toLowerCase();switch(s){case"years":case"year":case"yrs":case"yr":case"y":return e*Lo;case"weeks":case"week":case"w":return e*Ko;case"days":case"day":case"d":return e*le;case"hours":case"hour":case"hrs":case"hr":case"h":return e*ve;case"minutes":case"minute":case"mins":case"min":case"m":return e*be;case"seconds":case"second":case"secs":case"sec":case"s":return e*Ce;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return e;default:return}}}}function Go(t){var r=Math.abs(t);return r>=le?Math.round(t/le)+"d":r>=ve?Math.round(t/ve)+"h":r>=be?Math.round(t/be)+"m":r>=Ce?Math.round(t/Ce)+"s":t+"ms"}function $o(t){var r=Math.abs(t);return r>=le?Qe(t,r,le,"day"):r>=ve?Qe(t,r,ve,"hour"):r>=be?Qe(t,r,be,"minute"):r>=Ce?Qe(t,r,Ce,"second"):t+" ms"}function Qe(t,r,e,s){var o=r>=e*1.5;return Math.round(t/e)+" "+s+(o?"s":"")}});var Kr=j((za,Jr)=>{function zo(t){e.debug=e,e.default=e,e.coerce=y,e.disable=u,e.enable=o,e.enabled=c,e.humanize=Vr(),e.destroy=E,Object.keys(t).forEach(m=>{e[m]=t[m]}),e.names=[],e.skips=[],e.formatters={};function r(m){let f=0;for(let g=0;g<m.length;g++)f=(f<<5)-f+m.charCodeAt(g),f|=0;return e.colors[Math.abs(f)%e.colors.length]}e.selectColor=r;function e(m){let f,g=null,k,Y;function T(...S){if(!T.enabled)return;let N=T,H=Number(new Date),xe=H-(f||H);N.diff=xe,N.prev=f,N.curr=H,f=H,S[0]=e.coerce(S[0]),typeof S[0]!="string"&&S.unshift("%O");let X=0;S[0]=S[0].replace(/%([a-zA-Z%])/g,(te,Me)=>{if(te==="%%")return"%";X++;let oe=e.formatters[Me];if(typeof oe=="function"){let Ye=S[X];te=oe.call(N,Ye),S.splice(X,1),X--}return te}),e.formatArgs.call(N,S),(N.log||e.log).apply(N,S)}return T.namespace=m,T.useColors=e.useColors(),T.color=e.selectColor(m),T.extend=s,T.destroy=e.destroy,Object.defineProperty(T,"enabled",{enumerable:!0,configurable:!1,get:()=>g!==null?g:(k!==e.namespaces&&(k=e.namespaces,Y=e.enabled(m)),Y),set:S=>{g=S}}),typeof e.init=="function"&&e.init(T),T}function s(m,f){let g=e(this.namespace+(typeof f>"u"?":":f)+m);return g.log=this.log,g}function o(m){e.save(m),e.namespaces=m,e.names=[],e.skips=[];let f,g=(typeof m=="string"?m:"").split(/[\s,]+/),k=g.length;for(f=0;f<k;f++)!g[f]||(m=g[f].replace(/\*/g,".*?"),m[0]==="-"?e.skips.push(new RegExp("^"+m.slice(1)+"$")):e.names.push(new RegExp("^"+m+"$")))}function u(){let m=[...e.names.map(l),...e.skips.map(l).map(f=>"-"+f)].join(",");return e.enable(""),m}function c(m){if(m[m.length-1]==="*")return!0;let f,g;for(f=0,g=e.skips.length;f<g;f++)if(e.skips[f].test(m))return!1;for(f=0,g=e.names.length;f<g;f++)if(e.names[f].test(m))return!0;return!1}function l(m){return m.toString().substring(2,m.toString().length-2).replace(/\.\*\?$/,"*")}function y(m){return m instanceof Error?m.stack||m.message:m}function E(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return e.enable(e.load()),e}Jr.exports=zo});var tt=j(($,et)=>{$.formatArgs=Wo;$.save=Ho;$.load=Xo;$.useColors=Bo;$.storage=Zo();$.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();$.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Bo(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Wo(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+et.exports.humanize(this.diff),!this.useColors)return;let r="color: "+this.color;t.splice(1,0,r,"color: inherit");let e=0,s=0;t[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(e++,o==="%c"&&(s=e))}),t.splice(s,0,r)}$.log=console.debug||console.log||(()=>{});function Ho(t){try{t?$.storage.setItem("debug",t):$.storage.removeItem("debug")}catch{}}function Xo(){let t;try{t=$.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function Zo(){try{return localStorage}catch{}}et.exports=Kr()($);var{formatters:Qo}=et.exports;Qo.j=function(t){try{return JSON.stringify(t)}catch(r){return"[UnexpectedJSONParseError]: "+r.message}}});var se=j((Qa,it)=>{var en,tn,rn,nn,sn,on,an,un,cn,ot,It,ln,fn,Ae,pn,dn,mn,yn,_n,hn,gn,Cn,bn;(function(t){var r=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:{};typeof define=="function"&&define.amd?define("tslib",["exports"],function(s){t(e(r,e(s)))}):typeof it=="object"&&typeof it.exports=="object"?t(e(r,e(it.exports))):t(e(r));function e(s,o){return s!==r&&(typeof Object.create=="function"?Object.defineProperty(s,"__esModule",{value:!0}):s.__esModule=!0),function(u,c){return s[u]=o?o(u,c):c}}})(function(t){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var o in s)s.hasOwnProperty(o)&&(e[o]=s[o])};en=function(e,s){r(e,s);function o(){this.constructor=e}e.prototype=s===null?Object.create(s):(o.prototype=s.prototype,new o)},tn=Object.assign||function(e){for(var s,o=1,u=arguments.length;o<u;o++){s=arguments[o];for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&(e[c]=s[c])}return e},rn=function(e,s){var o={};for(var u in e)Object.prototype.hasOwnProperty.call(e,u)&&s.indexOf(u)<0&&(o[u]=e[u]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,u=Object.getOwnPropertySymbols(e);c<u.length;c++)s.indexOf(u[c])<0&&Object.prototype.propertyIsEnumerable.call(e,u[c])&&(o[u[c]]=e[u[c]]);return o},nn=function(e,s,o,u){var c=arguments.length,l=c<3?s:u===null?u=Object.getOwnPropertyDescriptor(s,o):u,y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(e,s,o,u);else for(var E=e.length-1;E>=0;E--)(y=e[E])&&(l=(c<3?y(l):c>3?y(s,o,l):y(s,o))||l);return c>3&&l&&Object.defineProperty(s,o,l),l},sn=function(e,s){return function(o,u){s(o,u,e)}},on=function(e,s){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,s)},an=function(e,s,o,u){function c(l){return l instanceof o?l:new o(function(y){y(l)})}return new(o||(o=Promise))(function(l,y){function E(g){try{f(u.next(g))}catch(k){y(k)}}function m(g){try{f(u.throw(g))}catch(k){y(k)}}function f(g){g.done?l(g.value):c(g.value).then(E,m)}f((u=u.apply(e,s||[])).next())})},un=function(e,s){var o={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},u,c,l,y;return y={next:E(0),throw:E(1),return:E(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function E(f){return function(g){return m([f,g])}}function m(f){if(u)throw new TypeError("Generator is already executing.");for(;o;)try{if(u=1,c&&(l=f[0]&2?c.return:f[0]?c.throw||((l=c.return)&&l.call(c),0):c.next)&&!(l=l.call(c,f[1])).done)return l;switch(c=0,l&&(f=[f[0]&2,l.value]),f[0]){case 0:case 1:l=f;break;case 4:return o.label++,{value:f[1],done:!1};case 5:o.label++,c=f[1],f=[0];continue;case 7:f=o.ops.pop(),o.trys.pop();continue;default:if(l=o.trys,!(l=l.length>0&&l[l.length-1])&&(f[0]===6||f[0]===2)){o=0;continue}if(f[0]===3&&(!l||f[1]>l[0]&&f[1]<l[3])){o.label=f[1];break}if(f[0]===6&&o.label<l[1]){o.label=l[1],l=f;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(f);break}l[2]&&o.ops.pop(),o.trys.pop();continue}f=s.call(e,o)}catch(g){f=[6,g],c=0}finally{u=l=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}},bn=function(e,s,o,u){u===void 0&&(u=o),e[u]=s[o]},cn=function(e,s){for(var o in e)o!=="default"&&!s.hasOwnProperty(o)&&(s[o]=e[o])},ot=function(e){var s=typeof Symbol=="function"&&Symbol.iterator,o=s&&e[s],u=0;if(o)return o.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&u>=e.length&&(e=void 0),{value:e&&e[u++],done:!e}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},It=function(e,s){var o=typeof Symbol=="function"&&e[Symbol.iterator];if(!o)return e;var u=o.call(e),c,l=[],y;try{for(;(s===void 0||s-- >0)&&!(c=u.next()).done;)l.push(c.value)}catch(E){y={error:E}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(y)throw y.error}}return l},ln=function(){for(var e=[],s=0;s<arguments.length;s++)e=e.concat(It(arguments[s]));return e},fn=function(){for(var e=0,s=0,o=arguments.length;s<o;s++)e+=arguments[s].length;for(var u=Array(e),c=0,s=0;s<o;s++)for(var l=arguments[s],y=0,E=l.length;y<E;y++,c++)u[c]=l[y];return u},Ae=function(e){return this instanceof Ae?(this.v=e,this):new Ae(e)},pn=function(e,s,o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var u=o.apply(e,s||[]),c,l=[];return c={},y("next"),y("throw"),y("return"),c[Symbol.asyncIterator]=function(){return this},c;function y(Y){u[Y]&&(c[Y]=function(T){return new Promise(function(S,N){l.push([Y,T,S,N])>1||E(Y,T)})})}function E(Y,T){try{m(u[Y](T))}catch(S){k(l[0][3],S)}}function m(Y){Y.value instanceof Ae?Promise.resolve(Y.value.v).then(f,g):k(l[0][2],Y)}function f(Y){E("next",Y)}function g(Y){E("throw",Y)}function k(Y,T){Y(T),l.shift(),l.length&&E(l[0][0],l[0][1])}},dn=function(e){var s,o;return s={},u("next"),u("throw",function(c){throw c}),u("return"),s[Symbol.iterator]=function(){return this},s;function u(c,l){s[c]=e[c]?function(y){return(o=!o)?{value:Ae(e[c](y)),done:c==="return"}:l?l(y):y}:l}},mn=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=e[Symbol.asyncIterator],o;return s?s.call(e):(e=typeof ot=="function"?ot(e):e[Symbol.iterator](),o={},u("next"),u("throw"),u("return"),o[Symbol.asyncIterator]=function(){return this},o);function u(l){o[l]=e[l]&&function(y){return new Promise(function(E,m){y=e[l](y),c(E,m,y.done,y.value)})}}function c(l,y,E,m){Promise.resolve(m).then(function(f){l({value:f,done:E})},y)}},yn=function(e,s){return Object.defineProperty?Object.defineProperty(e,"raw",{value:s}):e.raw=s,e},_n=function(e){if(e&&e.__esModule)return e;var s={};if(e!=null)for(var o in e)Object.hasOwnProperty.call(e,o)&&(s[o]=e[o]);return s.default=e,s},hn=function(e){return e&&e.__esModule?e:{default:e}},gn=function(e,s){if(!s.has(e))throw new TypeError("attempted to get private field on non-instance");return s.get(e)},Cn=function(e,s,o){if(!s.has(e))throw new TypeError("attempted to set private field on non-instance");return s.set(e,o),o},t("__extends",en),t("__assign",tn),t("__rest",rn),t("__decorate",nn),t("__param",sn),t("__metadata",on),t("__awaiter",an),t("__generator",un),t("__exportStar",cn),t("__createBinding",bn),t("__values",ot),t("__read",It),t("__spread",ln),t("__spreadArrays",fn),t("__await",Ae),t("__asyncGenerator",pn),t("__asyncDelegator",dn),t("__asyncValues",mn),t("__makeTemplateObject",yn),t("__importStar",_n),t("__importDefault",hn),t("__classPrivateFieldGet",gn),t("__classPrivateFieldSet",Cn)})});var at=j(C=>{"use strict";Object.defineProperty(C,"__esModule",{value:!0});C.KEYWORDS=C.MAIN_NOT_FOUND_ERR=C.ARG_NOT_MATCH_ERR=C.RESERVED_WORD_ERR=C.VALUE_KEY=C.IDX_KEY=C.PARAMS_KEY=C.NAME_KEY=C.RULES_KEY=C.PATTERN_KEY=C.PLUGIN_FN_KEY=C.PLUGIN_KEY=C.VALIDATE_ASYNC_KEY=C.VALIDATE_KEY=C.ARRAY_TYPE_RGT=C.ARRAY_TYPE_LFT=C.ARRAY_TS_TYPE_LFT=C.OBJECT_TYPE=C.ARRAY_TYPE=C.NUMBER_TYPE=C.STRING_TYPE=C.BOOLEAN_TYPE=C.OR_SEPERATOR=void 0;C.OR_SEPERATOR="|";C.BOOLEAN_TYPE="boolean";C.STRING_TYPE="string";C.NUMBER_TYPE="number";C.ARRAY_TYPE="array";C.OBJECT_TYPE="object";C.ARRAY_TS_TYPE_LFT="Array<";C.ARRAY_TYPE_LFT="array.<";C.ARRAY_TYPE_RGT=">";C.VALIDATE_KEY="validate";C.VALIDATE_ASYNC_KEY="validateAsync";C.PLUGIN_KEY="plugin";C.PLUGIN_FN_KEY="main";C.PATTERN_KEY="pattern";C.RULES_KEY="rules";C.NAME_KEY="name";C.PARAMS_KEY="params";C.IDX_KEY="$$idx";C.VALUE_KEY="$$value";C.RESERVED_WORD_ERR="Your plugin config argument contains reserved keywords";C.ARG_NOT_MATCH_ERR="Your params doesn't matching your main argument list";C.MAIN_NOT_FOUND_ERR="Can not find 'main' method in your plugin config";C.KEYWORDS=[C.PARAMS_KEY,C.PATTERN_KEY,C.VALIDATE_KEY,C.VALIDATE_ASYNC_KEY,C.PLUGIN_KEY,C.RULES_KEY,"name","type","types","server","tstype","value","optional","tmp","pos","lastResult"]});var De=j(ut=>{"use strict";Object.defineProperty(ut,"__esModule",{value:!0});ut.len=void 0;function si(t){return typeof t=="string"?t.length:t}ut.len=si});var Dt=j(Nt=>{"use strict";Object.defineProperty(Nt,"__esModule",{value:!0});var oi=De(),ii="moreThan";function ai(t,r){return(0,oi.len)(r)>t}Nt.default={name:ii,main:ai,params:["num"]}});var Jt=j(Vt=>{"use strict";Object.defineProperty(Vt,"__esModule",{value:!0});var ui=De(),ci="lessThan";function li(t,r){return(0,ui.len)(r)<t}Vt.default={name:ci,main:li,params:["num"]}});var Pn=j(Kt=>{"use strict";Object.defineProperty(Kt,"__esModule",{value:!0});var vn=se(),fi=vn.__importDefault(Dt()),pi=vn.__importDefault(Jt()),di="between";function mi(t,r,e){return pi.default.main(t,e)&&fi.default.main(r,e)}Kt.default={main:mi,name:di,params:["max","min"]}});var Fn=j(Lt=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});var yi="email";function _i(t){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)}Lt.default={main:_i,name:yi}});var An=j(Ee=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.name=void 0;Ee.name="int";function hi(t){return Number.isInteger(t)}Ee.default={name:Ee.name,main:hi}});var Gt=j(Ut=>{"use strict";Object.defineProperty(Ut,"__esModule",{value:!0});var gi=De(),Ci="lessThanEqual";function bi(t,r){return(0,gi.len)(r)<=t}Ut.default={name:Ci,main:bi,params:["num"]}});var zt=j($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});var vi=De(),Pi="moreThanEqual";function Fi(t,r){return(0,vi.len)(r)>=t}$t.default={name:Pi,main:Fi,params:["num"]}});var En=j(Bt=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});var Ai="unit";function Ei(t){return Number.isInteger(t)&&t>=0}Bt.default={name:Ai,main:Ei}});var On=j(Wt=>{"use strict";Object.defineProperty(Wt,"__esModule",{value:!0});var wn=se(),wi=wn.__importDefault(zt()),Oi=wn.__importDefault(Gt()),Ri="main";function ji(t,r,e){return Oi.default.main(t,e)&&wi.default.main(r,e)}Wt.default={name:Ri,main:ji,params:["max","min"]}});var Ht=j(ct=>{"use strict";Object.defineProperty(ct,"__esModule",{value:!0});ct.plugins=void 0;var re=se(),Ti=re.__importDefault(Pn()),Si=re.__importDefault(Fn()),qi=re.__importDefault(An()),xi=re.__importDefault(Gt()),Mi=re.__importDefault(Jt()),Yi=re.__importDefault(zt()),ki=re.__importDefault(Dt()),Ii=re.__importDefault(En()),Ni=re.__importDefault(On());ct.plugins=[Ti.default,Si.default,qi.default,xi.default,Mi.default,Yi.default,ki.default,Ii.default,Ni.default]});var jn=j(we=>{"use strict";Object.defineProperty(we,"__esModule",{value:!0});we.getPlugin=we.curryPlugin=void 0;var Rn=se(),Di=Ne(),Xt=Rn.__importDefault(Ie()),Vi=at(),Ji=Ht();function Ki(t,r){let{plugin:e}=t;if(e){let s=r[Vi.PARAMS_KEY];if(s){if(!Li(t,s))throw new Xt.default(`Expected params: ${s.join(",")} not found!`);let o=s.map(u=>t[u]);return Reflect.apply((0,Di.curry)(r.main),null,o)}else throw new Xt.default(`This plugin ${r.name} can not be curry`)}throw new Xt.default("Unable to find plugin in config")}we.curryPlugin=Ki;function Li(t,r){return r.filter(e=>t[e]).length===r.length}function Ui(t){let r=Ji.plugins[t];if(r)return r=r==="_"?t:r,Promise.resolve().then(()=>Rn.__importStar(vr("./"+[r,"js"].join("."))));throw new Error(`${t} is not found`)}we.getPlugin=Ui});var Sn=j(Oe=>{"use strict";Object.defineProperty(Oe,"__esModule",{value:!0});Oe.reversePromisifyResult=Oe.promisify=void 0;var Tn=se();function Gi(t){return(...r)=>Tn.__awaiter(this,void 0,void 0,function*(){let e=yield Reflect.apply(t,null,r);return e?Promise.resolve(e):Promise.reject(e)})}Oe.promisify=Gi;function $i(t){return(...r)=>Tn.__awaiter(this,void 0,void 0,function*(){let e=yield Reflect.apply(t,null,r);return e?Promise.reject(e):Promise.resolve(e)})}Oe.reversePromisifyResult=$i});var xn=j(Re=>{"use strict";Object.defineProperty(Re,"__esModule",{value:!0});Re.getRegex=Re.isRegExp=void 0;var zi=Ne();function qn(t){return t instanceof RegExp}Re.isRegExp=qn;function Bi(t){switch(!0){case qn(t):return t;case(0,zi.isString)(t):return new RegExp(t);default:return!1}}Re.getRegex=Bi});var Yn=j((yu,Mn)=>{var je=1e3,Te=je*60,Se=Te*60,fe=Se*24,Wi=fe*7,Hi=fe*365.25;Mn.exports=function(t,r){r=r||{};var e=typeof t;if(e==="string"&&t.length>0)return Xi(t);if(e==="number"&&isFinite(t))return r.long?Qi(t):Zi(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Xi(t){if(t=String(t),!(t.length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!r){var e=parseFloat(r[1]),s=(r[2]||"ms").toLowerCase();switch(s){case"years":case"year":case"yrs":case"yr":case"y":return e*Hi;case"weeks":case"week":case"w":return e*Wi;case"days":case"day":case"d":return e*fe;case"hours":case"hour":case"hrs":case"hr":case"h":return e*Se;case"minutes":case"minute":case"mins":case"min":case"m":return e*Te;case"seconds":case"second":case"secs":case"sec":case"s":return e*je;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return e;default:return}}}}function Zi(t){var r=Math.abs(t);return r>=fe?Math.round(t/fe)+"d":r>=Se?Math.round(t/Se)+"h":r>=Te?Math.round(t/Te)+"m":r>=je?Math.round(t/je)+"s":t+"ms"}function Qi(t){var r=Math.abs(t);return r>=fe?lt(t,r,fe,"day"):r>=Se?lt(t,r,Se,"hour"):r>=Te?lt(t,r,Te,"minute"):r>=je?lt(t,r,je,"second"):t+" ms"}function lt(t,r,e,s){var o=r>=e*1.5;return Math.round(t/e)+" "+s+(o?"s":"")}});var In=j((_u,kn)=>{function ea(t){e.debug=e,e.default=e,e.coerce=y,e.disable=u,e.enable=o,e.enabled=c,e.humanize=Yn(),e.destroy=E,Object.keys(t).forEach(m=>{e[m]=t[m]}),e.names=[],e.skips=[],e.formatters={};function r(m){let f=0;for(let g=0;g<m.length;g++)f=(f<<5)-f+m.charCodeAt(g),f|=0;return e.colors[Math.abs(f)%e.colors.length]}e.selectColor=r;function e(m){let f,g=null,k,Y;function T(...S){if(!T.enabled)return;let N=T,H=Number(new Date),xe=H-(f||H);N.diff=xe,N.prev=f,N.curr=H,f=H,S[0]=e.coerce(S[0]),typeof S[0]!="string"&&S.unshift("%O");let X=0;S[0]=S[0].replace(/%([a-zA-Z%])/g,(te,Me)=>{if(te==="%%")return"%";X++;let oe=e.formatters[Me];if(typeof oe=="function"){let Ye=S[X];te=oe.call(N,Ye),S.splice(X,1),X--}return te}),e.formatArgs.call(N,S),(N.log||e.log).apply(N,S)}return T.namespace=m,T.useColors=e.useColors(),T.color=e.selectColor(m),T.extend=s,T.destroy=e.destroy,Object.defineProperty(T,"enabled",{enumerable:!0,configurable:!1,get:()=>g!==null?g:(k!==e.namespaces&&(k=e.namespaces,Y=e.enabled(m)),Y),set:S=>{g=S}}),typeof e.init=="function"&&e.init(T),T}function s(m,f){let g=e(this.namespace+(typeof f>"u"?":":f)+m);return g.log=this.log,g}function o(m){e.save(m),e.namespaces=m,e.names=[],e.skips=[];let f,g=(typeof m=="string"?m:"").split(/[\s,]+/),k=g.length;for(f=0;f<k;f++)!g[f]||(m=g[f].replace(/\*/g,".*?"),m[0]==="-"?e.skips.push(new RegExp("^"+m.slice(1)+"$")):e.names.push(new RegExp("^"+m+"$")))}function u(){let m=[...e.names.map(l),...e.skips.map(l).map(f=>"-"+f)].join(",");return e.enable(""),m}function c(m){if(m[m.length-1]==="*")return!0;let f,g;for(f=0,g=e.skips.length;f<g;f++)if(e.skips[f].test(m))return!1;for(f=0,g=e.names.length;f<g;f++)if(e.names[f].test(m))return!0;return!1}function l(m){return m.toString().substring(2,m.toString().length-2).replace(/\.\*\?$/,"*")}function y(m){return m instanceof Error?m.stack||m.message:m}function E(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return e.enable(e.load()),e}kn.exports=ea});var Zt=j((z,ft)=>{z.formatArgs=ra;z.save=na;z.load=sa;z.useColors=ta;z.storage=oa();z.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();z.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function ta(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function ra(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+ft.exports.humanize(this.diff),!this.useColors)return;let r="color: "+this.color;t.splice(1,0,r,"color: inherit");let e=0,s=0;t[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(e++,o==="%c"&&(s=e))}),t.splice(s,0,r)}z.log=console.debug||console.log||(()=>{});function na(t){try{t?z.storage.setItem("debug",t):z.storage.removeItem("debug")}catch{}}function sa(){let t;try{t=z.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function oa(){try{return localStorage}catch{}}ft.exports=In()(z);var{formatters:ia}=ft.exports;ia.j=function(t){try{return JSON.stringify(t)}catch(r){return"[UnexpectedJSONParseError]: "+r.message}}});var Ln=j(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});I.patternPluginFanctory=I.isResultPackage=I.successThen=I.constructRuleCb=I.extractFnArgs=I.paramMatches=I.searchParamsKey=I.pluginHasFunc=I.checkPluginArg=void 0;var Ve=se(),aa=Ve.__importDefault(At()),ua=Ve.__importDefault(Ie()),ee=at(),ca=Ze(),la=ue(),fa=Tt(),pa=xn(),da=Ve.__importDefault(Zt()),pt=(0,da.default)("jsonql:validator-core:common");function Nn(t){return!(t.filter(r=>ee.KEYWORDS.includes(r)).length>0)}I.checkPluginArg=Nn;function ma(t){return t[ee.PLUGIN_FN_KEY]&&(0,fa.isFunction)(t[ee.PLUGIN_FN_KEY])}I.pluginHasFunc=ma;function Dn(t){let r=Vn(t.main.toString());return r.pop(),r}function ya(t){let r=Dn(t);if(r.length===0)return t;if(!Nn(r))throw new ua.default(ee.RESERVED_WORD_ERR);return t[ee.PARAMS_KEY]=r,t}I.searchParamsKey=ya;function _a(t){let r=Dn(t),e=r.length;if(e===0&&!t[ee.PARAMS_KEY])return!0;let s=t.params!==void 0&&Array.isArray(t.params)?t.params:!1;return s===!1?!1:e>0&&e===s.length&&!r.filter((o,u)=>o!==s[u]).length}I.paramMatches=_a;function Vn(t){return t.split("(")[1].split(")")[0].split(",").map(r=>r.trim()).filter(r=>r!=="")}I.extractFnArgs=Vn;function ha(t,r,e){return(s,o,u)=>Ve.__awaiter(this,void 0,void 0,function*(){return Reflect.apply(r,null,[s]).then(Jn(t,s,o,u)).catch(c=>(pt("failed",t,s,c,u),Promise.reject(new aa.default(e,u))))})}I.constructRuleCb=ha;function Jn(t,r,e,s){return o=>{let u=s[0];pt("passed",t,r,o,s),pt("lastResult",e);let c={[ee.IDX_KEY]:u,[ee.VALUE_KEY]:r};if(e===void 0)return{[t]:c};if(t in e){let l=e[t];return Kn(l)?l.includes(c)||e[t].push(c):l[ee.IDX_KEY]!==u&&(e[t]=(0,ca.toArray)(e[t]).concat([c])),e}return(0,la.assign)(e,{[t]:c})}}I.successThen=Jn;function Kn(t,r=ee.IDX_KEY){try{if(Array.isArray(t))return!!t.filter(e=>r in e).length}catch(e){pt("isResultPackage",e)}return!1}I.isResultPackage=Kn;function ga(t){let r=(0,pa.getRegex)(t);return e=>Ve.__awaiter(this,void 0,void 0,function*(){return r.test(e)?Promise.resolve(!0):Promise.reject(!1)})}I.patternPluginFanctory=ga});var $n=j(dt=>{"use strict";Object.defineProperty(dt,"__esModule",{value:!0});dt.ValidatorPlugins=void 0;var Gn=se(),Je=Gn.__importDefault(Ie()),J=at(),Ca=jn(),Un=Sn(),qe=Ln(),ba=Ht(),va=Gn.__importDefault(Zt()),pe=(0,va.default)("jsonql:validator-core:validator-plugin"),Qt=class{constructor(r){this.$version=r,this._plugins=new Map,this._internalPluginNames=[],ba.plugins.forEach(e=>{let s=e[J.NAME_KEY];this._internalPluginNames.push(s),this._registerPlugin(s,e,!0)})}lookupPlugin(r,e){let s=r[J.PLUGIN_KEY];if(s&&this._plugins.has(s)){let o=this._plugins.get(s);if(o[J.PLUGIN_FN_KEY]&&!o[J.PARAMS_KEY]&&(o[J.VALIDATE_ASYNC_KEY]=(0,Un.promisify)(o[J.PLUGIN_FN_KEY])),o&&o[J.VALIDATE_ASYNC_KEY]&&!o[J.PARAMS_KEY])return(0,qe.constructRuleCb)(e,o[J.VALIDATE_ASYNC_KEY],s);if(o&&o[J.PARAMS_KEY]){pe("pluginConfig --->",o),pe("input----------->",r);let u=r;return(0,qe.constructRuleCb)(e,(0,Un.promisify)((0,Ca.curryPlugin)(u,o)),s)}}throw pe("lookupPlugin","unable to find",s),new Je.default(`Unable to find plugin: ${s}`)}registerPlugin(r,e){this._registerPlugin(r,e)}_registerExternalPlugin(r,e){this._registerPlugin(r,e,!1,!0)}export(r=!0){let e=[];return this._plugins.forEach((s,o)=>{!this.isBuiltIn(o)&&s.external===r&&e.push(s)}),e}isBuiltIn(r){return this._internalPluginNames.includes(r)}_registerPlugin(r,e,s=!1,o=!1){if(!s){if(this._plugins.has(r))throw new Je.default(`plugin ${r} already existed!`);if(!(0,qe.pluginHasFunc)(e))throw pe("registerPlugin",J.MAIN_NOT_FOUND_ERR),new Je.default(J.MAIN_NOT_FOUND_ERR);if(e[J.PARAMS_KEY]===void 0)e=(0,qe.searchParamsKey)(e),pe("auto generate params for plugin",e);else if(e[J.PARAMS_KEY]!==void 0){if(!(0,qe.checkPluginArg)(e[J.PARAMS_KEY]))throw pe("registerPlugin",J.RESERVED_WORD_ERR),new Je.default(J.RESERVED_WORD_ERR);if(!(0,qe.paramMatches)(e))throw pe("registerPlugin",J.ARG_NOT_MATCH_ERR),new Je.default(J.ARG_NOT_MATCH_ERR)}}e.name=r,e.external=o,this._plugins.set(r,e)}};dt.ValidatorPlugins=Qt});var kt=U(At()),Wr=U(Ie()),Hr=U(jt()),Xr=U(Ze()),Fe=U(ue()),st=U(Tt()),Zr=U(jr());(()=>{var t=Object.create,r=Object.defineProperty,e=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,o=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty,c=(n,i)=>()=>(i||n((i={exports:{}}).exports,i),i.exports),l=(n,i,a,p)=>{if(i&&typeof i=="object"||typeof i=="function")for(let h of s(i))!u.call(n,h)&&h!==a&&r(n,h,{get:()=>i[h],enumerable:!(p=e(i,h))||p.enumerable});return n},y=(n,i,a)=>(a=n!=null?t(o(n)):{},l(i||!n||!n.__esModule?r(a,"default",{value:n,enumerable:!0}):a,n)),E=(n,i,a)=>new Promise((p,h)=>{var d=b=>{try{A(a.next(b))}catch(P){h(P)}},O=b=>{try{A(a.throw(b))}catch(P){h(P)}},A=b=>b.done?p(b.value):Promise.resolve(b.value).then(d,O);A((a=a.apply(n,i)).next())}),m=c(n=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.trueTypeOf=void 0;function i(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}n.trueTypeOf=i}),f=c(n=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.formatStr=n.showDeep=n.nil=n.createEvtName=n.parseJson=n.toArray=n.inArray=void 0;var i=k(),a=(P,x)=>P.includes(x);n.inArray=a;var p=P=>Array.isArray(P)?P:[P];n.toArray=p;var h=(P,x=!0)=>{try{return(0,i.isString)(P)?JSON.parse(P):JSON.parse(JSON.stringify(P))}catch(R){if(x)return P;throw R}};n.parseJson=h;var d=(...P)=>P.join("_");n.createEvtName=d;var O=()=>!1;n.nil=O;var A=P=>{console.dir(P,{depth:null})};n.showDeep=A;function b(P,...x){return P.replace(/{([0-9]+)}/g,(R,v)=>typeof x[v]>"u"?R:x[v])}n.formatStr=b}),g=c(n=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.readOnly=n.objectHasKey=n.arrToObj=n.assign=n.getConfigValue=n.isClass=n.isPlainObject=n.isObject=void 0;var i=f(),a=m();function p(R){return(0,a.trueTypeOf)(R)==="object"}n.isObject=p;function h(R){if(p(R)){let v=R.constructor.prototype,_="[Object: null prototype]";return v.toString().substring(0,_.length)===_?!0:p(v)===!1?!1:Reflect.apply(v.hasOwnProperty,v,["isPrototypeOf"])}return!1}n.isPlainObject=h;var d=R=>!h(R);n.isClass=d;var O=(R,v)=>v&&h(v)&&R in v?v[R]:void 0;n.getConfigValue=O;var A=(...R)=>Reflect.apply(Object.assign,Object,R);n.assign=A;var b=(R,v,_={})=>R.map(v).reduce((F,M)=>(0,n.assign)(F,M),_);n.arrToObj=b;var P=(R,v)=>{try{let _=Object.keys(R);return(0,i.inArray)(_,v)}catch{return!1}};n.objectHasKey=P;var x=R=>Object.freeze(R);n.readOnly=x}),k=c(n=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isString=n.flatMap=n.merge=n.curry=void 0;var i=m(),a=g(),p=(A,...b)=>A.length<=b.length?A(...b):(...P)=>(0,n.curry)(A,...b,...P);n.curry=p;var h=(A,...b)=>{if(!b.length)return A;let P=b.shift();if((0,a.isObject)(A)&&(0,a.isObject)(P))for(let x in P)(0,a.isObject)(P[x])?(A[x]||Object.assign(A,{[x]:{}}),(0,n.merge)(A[x],P[x])):Object.assign(A,{[x]:P[x]});return(0,n.merge)(A,...b)};n.merge=h;function d(A,b){return b||(b=P=>P),A.flatMap(b)}n.flatMap=d;function O(A){return(0,i.trueTypeOf)(A)==="string"}n.isString=O}),Y=c(n=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.queuePromisesProcess=n.chainProcessPromises=n.chainPromises=void 0;var i=k(),a=g();function p(O,A=!1){return O.reduce((b,P)=>b.then(x=>P.then(R=>A===!1?[...x,R]:(0,i.merge)(x,R))),Promise.resolve(A===!1?[]:(0,a.isPlainObject)(A)?A:{}))}n.chainPromises=p;function h(O,...A){return(...b)=>A.reduce((P,x)=>P.then(R=>x(R)),Reflect.apply(O,null,b))}n.chainProcessPromises=h;function d(O,...A){let b=(0,i.flatMap)(O),P=Reflect.apply(h,null,b);return Reflect.apply(P,null,A)}n.queuePromisesProcess=d}),T=c(n=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=class extends Error{constructor(...a){super(...a),this.message=a[0],this.detail=a[1],this.className=i.name,Error.captureStackTrace&&Error.captureStackTrace(this,i)}};n.default=i}),S=c(n=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=class extends Error{constructor(...a){super(...a),this.message=a[0],this.detail=a[1],this.className=i.name,Error.captureStackTrace&&Error.captureStackTrace(this,i)}};n.default=i}),N=c(n=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isAsyncFunction=n.isFunction=void 0;var i=m(),a=["asyncfunction","function"],p=function(d,O=!1){let A=(0,i.trueTypeOf)(d);return a.includes(A)?!0:(O&&console.error(`Expect to be Function type! Got ${typeof d}`),!1)};n.isFunction=p;function h(d){return(0,i.trueTypeOf)(d)===a[0]}n.isAsyncFunction=h}),H=c(n=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getRegex=n.isRegExp=void 0;var i=k();function a(h){return h instanceof RegExp}n.isRegExp=a;function p(h){switch(!0){case a(h):return h;case(0,i.isString)(h):return new RegExp(h);default:return!1}}n.getRegex=p}),xe=c((n,i)=>{var a=1e3,p=a*60,h=p*60,d=h*24,O=d*7,A=d*365.25;i.exports=function(v,_){_=_||{};var F=typeof v;if(F==="string"&&v.length>0)return b(v);if(F==="number"&&isFinite(v))return _.long?x(v):P(v);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(v))};function b(v){if(v=String(v),!(v.length>100)){var _=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(v);if(_){var F=parseFloat(_[1]),M=(_[2]||"ms").toLowerCase();switch(M){case"years":case"year":case"yrs":case"yr":case"y":return F*A;case"weeks":case"week":case"w":return F*O;case"days":case"day":case"d":return F*d;case"hours":case"hour":case"hrs":case"hr":case"h":return F*h;case"minutes":case"minute":case"mins":case"min":case"m":return F*p;case"seconds":case"second":case"secs":case"sec":case"s":return F*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return F;default:return}}}}function P(v){var _=Math.abs(v);return _>=d?Math.round(v/d)+"d":_>=h?Math.round(v/h)+"h":_>=p?Math.round(v/p)+"m":_>=a?Math.round(v/a)+"s":v+"ms"}function x(v){var _=Math.abs(v);return _>=d?R(v,_,d,"day"):_>=h?R(v,_,h,"hour"):_>=p?R(v,_,p,"minute"):_>=a?R(v,_,a,"second"):v+" ms"}function R(v,_,F,M){var me=_>=F*1.5;return Math.round(v/F)+" "+M+(me?"s":"")}}),X=c((n,i)=>{function a(p){d.debug=d,d.default=d,d.coerce=R,d.disable=b,d.enable=A,d.enabled=P,d.humanize=xe(),d.destroy=v,Object.keys(p).forEach(_=>{d[_]=p[_]}),d.names=[],d.skips=[],d.formatters={};function h(_){let F=0;for(let M=0;M<_.length;M++)F=(F<<5)-F+_.charCodeAt(M),F|=0;return d.colors[Math.abs(F)%d.colors.length]}d.selectColor=h;function d(_){let F,M=null,me,hr;function Q(...B){if(!Q.enabled)return;let ae=Q,Be=Number(new Date),ro=Be-(F||Be);ae.diff=ro,ae.prev=F,ae.curr=Be,F=Be,B[0]=d.coerce(B[0]),typeof B[0]!="string"&&B.unshift("%O");let We=0;B[0]=B[0].replace(/%([a-zA-Z%])/g,(Pt,no)=>{if(Pt==="%%")return"%";We++;let gr=d.formatters[no];if(typeof gr=="function"){let so=B[We];Pt=gr.call(ae,so),B.splice(We,1),We--}return Pt}),d.formatArgs.call(ae,B),(ae.log||d.log).apply(ae,B)}return Q.namespace=_,Q.useColors=d.useColors(),Q.color=d.selectColor(_),Q.extend=O,Q.destroy=d.destroy,Object.defineProperty(Q,"enabled",{enumerable:!0,configurable:!1,get:()=>M!==null?M:(me!==d.namespaces&&(me=d.namespaces,hr=d.enabled(_)),hr),set:B=>{M=B}}),typeof d.init=="function"&&d.init(Q),Q}function O(_,F){let M=d(this.namespace+(typeof F>"u"?":":F)+_);return M.log=this.log,M}function A(_){d.save(_),d.namespaces=_,d.names=[],d.skips=[];let F,M=(typeof _=="string"?_:"").split(/[\s,]+/),me=M.length;for(F=0;F<me;F++)!M[F]||(_=M[F].replace(/\*/g,".*?"),_[0]==="-"?d.skips.push(new RegExp("^"+_.slice(1)+"$")):d.names.push(new RegExp("^"+_+"$")))}function b(){let _=[...d.names.map(x),...d.skips.map(x).map(F=>"-"+F)].join(",");return d.enable(""),_}function P(_){if(_[_.length-1]==="*")return!0;let F,M;for(F=0,M=d.skips.length;F<M;F++)if(d.skips[F].test(_))return!1;for(F=0,M=d.names.length;F<M;F++)if(d.names[F].test(_))return!0;return!1}function x(_){return _.toString().substring(2,_.toString().length-2).replace(/\.\*\?$/,"*")}function R(_){return _ instanceof Error?_.stack||_.message:_}function v(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return d.enable(d.load()),d}i.exports=a}),Ke=c((n,i)=>{n.formatArgs=p,n.save=h,n.load=d,n.useColors=a,n.storage=O(),n.destroy=(()=>{let b=!1;return()=>{b||(b=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function a(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function p(b){if(b[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+b[0]+(this.useColors?"%c ":" ")+"+"+i.exports.humanize(this.diff),!this.useColors)return;let P="color: "+this.color;b.splice(1,0,P,"color: inherit");let x=0,R=0;b[0].replace(/%[a-zA-Z%]/g,v=>{v!=="%%"&&(x++,v==="%c"&&(R=x))}),b.splice(R,0,P)}n.log=console.debug||console.log||(()=>{});function h(b){try{b?n.storage.setItem("debug",b):n.storage.removeItem("debug")}catch{}}function d(){let b;try{b=n.storage.getItem("debug")}catch{}return!b&&typeof process<"u"&&"env"in process&&(b=process.env.DEBUG),b}function O(){try{return localStorage}catch{}}i.exports=X()(n);var{formatters:A}=i.exports;A.j=function(b){try{return JSON.stringify(b)}catch(P){return"[UnexpectedJSONParseError]: "+P.message}}}),te=y(k());function Me(n){return(n+"").trim()!==""?(0,te.isString)(n):!1}function oe(n){return n!=null&&typeof n=="boolean"}var Ye=y(m());function Wn(n){return(0,Ye.trueTypeOf)(n)!=="number"?!1:!isNaN(parseFloat(n+""))}function Pa(n){console.log("@TODO checkInteger",n)}function Fa(n){console.log("@TODO checkFloat",n)}function Aa(n){console.log("@TODO check unsigned",n)}function Hn(n,i=!0){return n!==void 0&&n!==""&&(n+"").trim()!==""&&(i===!1||i===!0&&n!==null)}var Xn=y(g()),tr="|",Zn="boolean",Qn="string",es="number",yt="array",_t="object",ts="Array<",rs="array.<",rr=">",ns="validate",Le="validateAsync",nr="plugin",Ue="main",ss="pattern",os="rules",is="name",Z="params",ht="$$idx",as="$$value",gt="Your plugin config argument contains reserved keywords",sr="Your params doesn't matching your main argument list",or="Can not find 'main' method in your plugin config",us=[Z,ss,ns,Le,nr,os,"name","type","types","server","tstype","value","optional","tmp","pos","lastResult"];function de(n){switch(n){case es:return Wn;case Qn:return Me;case Zn:return oe;default:return Hn}}var ir={ts,jsdoc:rs};function Ge(n,i){if(Array.isArray(n)){if(!i)return!0;let a;return Array.isArray(i)?a=n.filter(p=>{let h=i.length;for(let d=0;d<h;++d){let O=i[d];if(O===yt&&Array.isArray(p)||O===_t&&(0,Xn.isPlainObject)(p)||de(O)(p))return!1}return!0}):a=n.filter(p=>!de(i)(p)),!(a.length>0)}return!1}function ar(n,i="ts"){let a=ir[i];if(!a)throw new Error(`Syntax not supported! ${Object.keys(ir)}`);if(n.indexOf(a)>-1&&n.indexOf(rr)>-1){let p=n.replace(a,"").replace(rr,"");return p.indexOf(tr)?p.split(tr):[p]}return!1}function cs(n){return ar(n)?!1:ar(n,"jsdoc")}function ls(n,i){let{arg:a}=n;return i.length>1?!a.filter(p=>!(i.length>i.filter(h=>!de(h)(p)).length)).length:i.length>i.filter(p=>!Ge(a,p)).length}var ur=y(g());function Ct(n,i){if((0,ur.isPlainObject)(n)){if(!i)return!0;if(typeof i=="string")return i in n;if(Ge(i))return typeof i[0]=="string"?fs(n,i):ps(n,i)}return!1}function fs(n,i){return!i.filter(a=>!(a in n)).length}function ps(n,i){return!i.filter(a=>{let p=n[a.name];return!(a.type.length>a.type.filter(h=>{let d;return p!==void 0?(d=cs(h))!==!1?!ls({arg:p},d):!de(h)(p):!0}).length)}).length}var Ea=function(n){let{arg:i,param:a}=n,p=[i];return Array.isArray(a.keys)&&a.keys.length&&p.push(a.keys),Reflect.apply(Ct,null,p)},wa=function(n){return(0,ur.isPlainObject)(n)?!Object.keys(n).length:!1},ds=y(Y());function bt(n,i){return n||i}function ms(n,i,a){return i.map((p,h)=>{let d=[n];switch(a&&a[h]&&d.push(a[h]),p){case yt:return()=>bt(Reflect.apply(Ge,null,d),p);case _t:return()=>bt(Reflect.apply(Ct,null,d),p);default:return()=>bt(de(p)(n),p)}}).map(p=>()=>E(this,null,function*(){let h=p();return h===!0?Promise.reject(!0):Promise.resolve(h)}))}function Oa(n,i,a){return E(this,null,function*(){let p=ms(n,i,a);return new Promise((h,d)=>{(0,ds.queuePromisesProcess)(p,i[0]).then(O=>{d(O)}).catch(O=>{h(O)})})})}function Ra(n,i){let a=i.length;for(let p=0;p<a;++p){let h=i[p];switch(h){case yt:if(Ge(n))return!0;break;case _t:if(Ct(n))return!0;break;default:if(de(h)(n))return!0}}return!1}function cr(n){return(...i)=>E(this,null,function*(){let a=yield Reflect.apply(n,null,i);return a?Promise.resolve(a):Promise.reject(a)})}function ja(n){return(...i)=>E(this,null,function*(){let a=yield Reflect.apply(n,null,i);return a?Promise.reject(a):Promise.resolve(a)})}function $e(n){return typeof n=="string"?n.length:n}var ys="moreThan";function _s(n,i){return $e(i)>n}var lr={name:ys,main:_s,params:["num"]},hs="lessThan";function gs(n,i){return $e(i)<n}var fr={name:hs,main:gs,params:["num"]},Cs="between";function bs(n,i,a){return fr.main(n,a)&&lr.main(i,a)}var vs={main:bs,name:Cs,params:["max","min"]},Ps="email";function Fs(n){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(n)}var As={main:Fs,name:Ps},Es="int";function ws(n){return Number.isInteger(n)}var Os={name:Es,main:ws},Rs="lessThanEqual";function js(n,i){return $e(i)<=n}var pr={name:Rs,main:js,params:["num"]},Ts="moreThanEqual";function Ss(n,i){return $e(i)>=n}var dr={name:Ts,main:Ss,params:["num"]},qs="unit";function xs(n){return Number.isInteger(n)&&n>=0}var Ms={name:qs,main:xs},Ys="main";function ks(n,i,a){return pr.main(n,a)&&dr.main(i,a)}var Is={name:Ys,main:ks,params:["max","min"]},Ns=[vs,As,Os,pr,fr,dr,lr,Ms,Is],Ds=y(k()),vt=y(T());function Vs(n,i){let{plugin:a}=n;if(a){let p=i[Z];if(p){if(!Js(n,p))throw new vt.default(`Expected params: ${p.join(",")} not found!`);let h=p.map(d=>n[d]);return Reflect.apply((0,Ds.curry)(i.main),null,h)}else throw new vt.default(`This plugin ${i.name} can not be curry`)}throw new vt.default("Unable to find plugin in config")}function Js(n,i){return i.filter(a=>n[a]).length===i.length}var Ks=y(S()),Ls=y(T()),Us=y(f()),Gs=y(g()),$s=y(N()),zs=y(H()),Bs=y(Ke()),ze=(0,Bs.default)("jsonql:validator-core:common");function mr(n){return!(n.filter(i=>us.includes(i)).length>0)}function Ws(n){return n[Ue]&&(0,$s.isFunction)(n[Ue])}function yr(n){let i=Zs(n.main.toString());return i.pop(),i}function Hs(n){let i=yr(n);if(i.length===0)return n;if(!mr(i))throw new Ls.default(gt);return n[Z]=i,n}function Xs(n){let i=yr(n),a=i.length;if(a===0&&!n[Z])return!0;let p=n.params!==void 0&&Array.isArray(n.params)?n.params:!1;return p===!1?!1:a>0&&a===p.length&&!i.filter((h,d)=>h!==p[d]).length}function Zs(n){return n.split("(")[1].split(")")[0].split(",").map(i=>i.trim()).filter(i=>i!=="")}function _r(n,i,a){return(p,h,d)=>E(this,null,function*(){return Reflect.apply(i,null,[p]).then(Qs(n,p,h,d)).catch(O=>(ze("failed",n,p,O,d),Promise.reject(new Ks.default(a,d))))})}function Qs(n,i,a,p){return h=>{let d=p[0];ze("passed",n,i,h,p),ze("lastResult",a);let O={[ht]:d,[as]:i};if(a===void 0)return{[n]:O};if(n in a){let A=a[n];return eo(A)?A.includes(O)||a[n].push(O):A[ht]!==d&&(a[n]=(0,Us.toArray)(a[n]).concat([O])),a}return(0,Gs.assign)(a,{[n]:O})}}function eo(n,i=ht){try{if(Array.isArray(n))return!!n.filter(a=>i in a).length}catch(a){ze("isResultPackage",a)}return!1}function Ta(n){let i=(0,zs.getRegex)(n);return a=>E(this,null,function*(){return i.test(a)?Promise.resolve(!0):Promise.reject(!1)})}var ke=y(T()),to=y(Ke()),ie=(0,to.default)("jsonql:validator-core:validator-plugin"),Sa=class{constructor(n){this.$version=n,this._plugins=new Map,this._internalPluginNames=[],Ns.forEach(i=>{let a=i[is];this._internalPluginNames.push(a),this._registerPlugin(a,i,!0)})}lookupPlugin(n,i){let a=n[nr];if(a&&this._plugins.has(a)){let p=this._plugins.get(a);if(p[Ue]&&!p[Z]&&(p[Le]=cr(p[Ue])),p&&p[Le]&&!p[Z])return _r(i,p[Le],a);if(p&&p[Z])return ie("pluginConfig --->",p),ie("input----------->",n),_r(i,cr(Vs(n,p)),a)}throw ie("lookupPlugin","unable to find",a),new ke.default(`Unable to find plugin: ${a}`)}registerPlugin(n,i){this._registerPlugin(n,i)}_registerExternalPlugin(n,i){this._registerPlugin(n,i,!1,!0)}export(n=!0){let i=[];return this._plugins.forEach((a,p)=>{!this.isBuiltIn(p)&&a.external===n&&i.push(a)}),i}isBuiltIn(n){return this._internalPluginNames.includes(n)}_registerPlugin(n,i,a=!1,p=!1){if(!a){if(this._plugins.has(n))throw new ke.default(`plugin ${n} already existed!`);if(!Ws(i))throw ie("registerPlugin",or),new ke.default(or);if(i[Z]===void 0)i=Hs(i),ie("auto generate params for plugin",i);else if(i[Z]!==void 0){if(!mr(i[Z]))throw ie("registerPlugin",gt),new ke.default(gt);if(!Xs(i))throw ie("registerPlugin",sr),new ke.default(sr)}}i.name=n,i.external=p,this._plugins.set(n,i)}}})();var Tr="Input argument is not an array!";var Sr="Exception happened don't know how to handle it",qr="$_spread_arg_",ce="$$is_spread_values",ge="RestElement",xr="TsUnionType",Mr="TsArrayType",St="defaultvalue",Yr="TsTypeLiteral",kr="TsTypeReference",qt="tstype",Ir="object",xt="array",Nr="raw";var Lr=U(jt()),rt=U(ue()),Ur=U(tt()),Pe=(0,Ur.default)("jsonql:validator:class:fn");function Gr(t){return t.map(r=>{let{name:e}=r,s=ni(r),o=r[qt]||r.type;return Pe("createAutomaticRules",e,o),r[void 0]=[(void 0)(e,s,o)],r})}function $r(t,r){return D(this,null,function*(){return ei(t,r).then(ri)})}function zr(t,r){return ti(t,r).reduce((e,s)=>(0,rt.assign)(e,s),{})}function ei(t,r){return D(this,null,function*(){return t.map(e=>void 0 in r[e]?r[e][void 0]:(void 0)(r[e])?{[ce]:r[e].map(s=>s[void 0])}:(Pe(`Return result when we couldn't find way to destruct: ${e}`,r[e]),r[e]))})}function ti(t,r){return t.map(e=>{switch(!0){case void 0 in r[e]:return{[e]:r[e][void 0]};case(void 0)(r[e]):return{[e]:r[e].map(s=>s[void 0])};default:return{[e]:r[e]}}})}function ri(t){return D(this,null,function*(){Pe("unwrapPreparedValidateResult",t);let r=t.length;if(r===1&&(0,rt.objectHasKey)(t[0],ce))return t[0][ce];if((void 0)(t,ce)){let e=[];for(let s=0;s<r;++s)ce in t[s]?e=e.concat(t[s][ce]):e.push(t[s]);return e}return t})}function ni(t){switch(Pe("getValidateRules ast",t),t[qt]){case xr:return function(e){return D(this,null,function*(){return(void 0)(e,t.type)})};case(Mr||ge):return function(e){return D(this,null,function*(){return(void 0)(void 0)(e,t.types)})};case(kr||Yr):return function(e){return D(this,null,function*(){return(void 0)(void 0)(e)})};case ge:return function(e){return D(this,null,function*(){return(void 0)((void 0)(t.types))(e)})};default:return(void 0)(t.type)?(Pe("validation type",t.type),function(e){return D(this,null,function*(){return(void 0)((void 0)(t.type))(e)})}):(Pe("getValidateRules",t),function(e){return D(this,null,function*(){return(void 0)(Lr.notEmpty)(e,!0)})})}}function Mt(t,r){return r.tstype!==ge&&t===void 0?r[St]!==void 0?r[St]:void 0:t}function Br(t){return[void 0,void 0,void 0].filter(r=>t[r]!==void 0)}function Yt(t){let r=Object.keys(t);return r.length?r[0]:void 0}var Qr=U(tt()),L=(0,Qr.default)("jsonql:validator:validator-base"),nt=class{constructor(r,e){this._validatorPluginsInstance=e;this._astWithBaseRules=Gr(r),this._arguments=this._astWithBaseRules.map(s=>s[void 0])}validate(r){let e=this._normalizeArgValues(r);return(0,Zr.queuePromisesProcess)(e,void 0)}prepareArgValues(r){return this._normalizeArgValues(r,!1)}get schema(){return this._schema||this._astWithBaseRules}addValidationRules(r){L("addValidationRules",r);let e={};for(let s in r)e[s]=(0,Xr.toArray)(r[s]).map(o=>(0,st.isFunction)(o)?this._updateInput(o):o);this._createSchema(e)}_updateInput(r){return{[void 0]:(0,st.isAsyncFunction)(r)?r:(void 0)(r)}}_normalizeArgValues(r,e=!0){L("_normalizeArgValues",r);let s=this.schema,o=s.length;if(o===0)return[];if(!(void 0)(r))throw L(r),new kt.default(Tr,r);let u=r.length;switch(!0){case u===o:return e===!1?(0,Fe.arrToObj)(r,(c,l)=>({[s[l].name]:c})):r.map((c,l)=>this._prepareForExecution(c,s[l],l));case u<o:return L("Values pass less than params"),e===!1?(0,Fe.arrToObj)(s,(c,l)=>{let y=Mt(r[l],c);return{[c.name]:y}}):s.map((c,l)=>{let y=Mt(r[l],c);return this._prepareForExecution(y,c,l)});case u>o:return L("spread params",u,o),this._processSpreadLikeArg(r,s,e);default:throw new kt.default(Sr,[u,o])}}_processSpreadLikeArg(r,e,s){let o=e.filter(u=>u.tstype===ge)[0];return s===!1?r.map((u,c)=>e[c]?e[c].name!==o.name?{[e[c].name]:u}:{[o.name]:[u]}:{[o.name]:[u]}).reduce((u,c)=>{if(!Yt(u))return c;let y=Yt(c);return u[y]?(u[y]=u[y].concat(c[y]),u):(0,Fe.assign)({},u,c)},{}):r.map((u,c)=>{let l=e[c]||(0,Fe.assign)({},o,{name:`${qr}${c}`});return L("spread param",u,l.name),this._prepareForExecution(u,l,c)})}_prepareForExecution(r,e,s){let{rules:o,required:u,name:c}=e;return o&&o.length?o.map((l,y)=>r===void 0&&!u?(L("skip the validation",u),E=>D(this,null,function*(){return(void 0)(c,r,E,[s,y])(!0)})):E=>D(this,null,function*(){return Reflect.apply(l,null,[r,E,[s,y]]).then(m=>(L("Post rule result",m),m))})):(L("No rules to run"),()=>D(this,null,function*(){return!0}))}_createSchema(r){let e=this._astWithBaseRules;(0,Hr.notEmpty)(r,!0)&&(e=this._applyObjectInput(e,r)),L("_createSchema",e),this._schema=e}_applyObjectInput(r,e){return r.map(s=>{var u;let o=s.name;if(e[o]){let c=e[o].map(y=>(y.name=o,y)),l=this._transformInput(c,o);l&&l.length&&(s[void 0]=(u=s[void 0])==null?void 0:u.concat(l))}return s})}_transformInput(r,e){return L("_transformInput",r),r.map((s,o)=>{let u=Br(s);if(u.length>1)throw new Error(`You can only set one rule at a time! We found ${u.join(",")}`);let c=s.name||`customPluginName${o}`;switch(!0){case s[void 0]!==void 0:return L("Should got here ----->",s[void 0]),this._lookupPlugin(s,e);case s[void 0]!==void 0:return L(`${void 0} ----->`,s),(void 0)(e,(void 0)(s[void 0]),c);case s[void 0]!==void 0:return L(`${void 0} ---->`,s),(void 0)(e,s[void 0],c);default:throw new Wr.default(`unable to find rule for ${e},
            we expect ${void 0}, ${void 0} or ${void 0}`)}})}_lookupPlugin(r,e){try{if(this._validatorPluginsInstance)return L("_lookupPlugin --->",r,e),this._validatorPluginsInstance.lookupPlugin(r,e)}catch(s){L("catch _lookupPlugin error",s)}return(void 0)(e,()=>D(this,null,function*(){return Promise.reject(!1)}),"NO_PLUGIN_DUMMY_FUNCTION")}};var er=U($n());var Bn=U(tt()),zn=(0,Bn.default)("jsonql:validator:class:index"),mt=class extends nt{constructor(r,e){super(r,e&&e instanceof er.ValidatorPlugins?e:new er.ValidatorPlugins(-1))}validate(s){return D(this,arguments,function*(r,e=xt){return Pr(mt.prototype,this,"validate").call(this,r).then(o=>{switch(e){case Nr:return o;case xt:return this._prepareValidateResultForFuncCall(o);case Ir:default:return this._prepareValidateResultAsObject(o)}})})}registerPlugin(r,e){this._validatorPluginsInstance&&this._validatorPluginsInstance.registerPlugin(r,e)}_prepareValidateResultForFuncCall(r){return D(this,null,function*(){return zn("validateResult return as array",this._arguments,r),$r(this._arguments,r)})}_prepareValidateResultAsObject(r){return D(this,null,function*(){return zn("validateResult return as object",this._arguments,r),zr(this._arguments,r)})}};export{mt as Validator};
/*!
 * More accurately check the type of a JavaScript object
 * (c) 2021 Chris Ferdinandi, MIT License, https://gomakethings.com
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
//# sourceMappingURL=esm.js.map
